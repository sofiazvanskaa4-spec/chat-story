<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Chat Story</title>

<style>
body{
  margin:0;
  background:#000;
  font-family:Arial, sans-serif;
  color:#fff;
}

#chat{
  padding:15px;
  padding-bottom:120px;
  display:flex;
  flex-direction:column;
  gap:12px;
}

/* ПУЗЫРЬ */
.bubble{
  display:flex;
  gap:8px;
  max-width:80%;
  align-items:flex-end;
}

.left{align-self:flex-start;}
.right{align-self:flex-end; flex-direction:row-reverse;}

.msg{
  background:#2a2a2a;
  padding:10px 14px;
  border-radius:14px;
  font-size:15px;
  line-height:1.4;
}

.right .msg{background:#5a2cff;}

.avatar{
  width:36px;
  height:36px;
  border-radius:50%;
  object-fit:cover;
}

/* МЕДИА В ЧАТЕ */
video, img.media{
  max-width:220px;
  border-radius:14px;
}

/* ВЫБОРЫ */
#choices{
  position:fixed;
  bottom:0;
  width:100%;
  background:#111;
  display:none;
  flex-direction:column;
  z-index:10;
}

.choice{
  padding:15px;
  border-top:1px solid #222;
  text-align:center;
  cursor:pointer;
}

.choice:hover{background:#1b1b1b;}

#tap{
  position:fixed;
  bottom:0;
  width:100%;
  padding:15px;
  text-align:center;
  background:#111;
  cursor:pointer;
  user-select:none;
}
</style>
</head>

<body>

<div id="chat"></div>
<div id="choices"></div>
<div id="tap">Нажми, чтобы продолжить</div>

<script>
/* ===== ПЕРСОНАЖИ ===== */
const characters = {
  ella:{name:"Элла",side:"right",avatar:"img/ella.jpg"},
  eric:{name:"Эрик",side:"left",avatar:"img/eric.jpg"},
  natalie:{name:"Натали",side:"left",avatar:"img/natalie.jpg"},
  kate:{name:"Кейт",side:"left",avatar:"img/kate.jpg"},
  michael:{name:"Майкл",side:"left",avatar:"img/michael.jpg"},
  father:{name:"Папа",side:"left",avatar:"img/father.jpg"},
  stepmother:{name:"Мачеха",side:"left",avatar:"img/stepmother.jpg"},
  brother1:{name:"Брат 1",side:"left",avatar:"img/brother1.jpg"},
  brother2:{name:"Брат 2",side:"left",avatar:"img/brother2.jpg"},
  john:{name:"Джон",side:"left",avatar:"img/john.jpg"},
  lucas:{name:"Лукас",side:"left",avatar:"img/lucas.jpg"},
  guy:{name:"Парень",side:"left",avatar:"img/guy.jpg"},
  unknown:{name:"Неизвестный",side:"left",avatar:"img/unknown.jpg"},
  existence:{name:"Существо",side:"left",avatar:"img/existence.jpg"},
  doctor:{name:"Врач",side:"left",avatar:"img/doctor.jpg"},
  author:{name:"Автор",side:"left",avatar:"img/author.jpg"},
  olivia:{name:"Оливия",side:"left",avatar:"img/olivia.jpg"},
  mother:{name:"Мама",side:"left",avatar:"img/mother.jpg"},
  seller:{name:"Продавец",side:"left",avatar:"img/seller.jpg"}
};

/* ===== ИСТОРИЯ (ПОКА МОЖЕТ БЫТЬ ПУСТОЙ) ===== */
const story = [
  // { char:"author", text:"Начало истории" },
  // { char:"author", video:"video/scene1.mp4" },
  // {
  //   choices:[
  //     { text:"Выбор 1", next:3 },
  //     { text:"Выбор 2", next:5 }
  //   ]
  // },
  // { char:"ella", text:"Что происходит?" }
];

/* ===== ЛОГИКА ===== */
let index = 0;
const chat = document.getElementById("chat");
const tap = document.getElementById("tap");
const choicesBox = document.getElementById("choices");

tap.onclick = nextStep;

function nextStep(){
  if(index >= story.length) return;

  const step = story[index];

  /* ВЫБОРЫ */
  if(step.choices){
    tap.style.display="none";
    choicesBox.style.display="flex";
    choicesBox.innerHTML="";
    step.choices.forEach(c=>{
      const btn=document.createElement("div");
      btn.className="choice";
      btn.textContent=c.text;
      btn.onclick=()=>{
        choicesBox.style.display="none";
        tap.style.display="block";
        index=c.next;
        nextStep();
      };
      choicesBox.appendChild(btn);
    });
    return;
  }

  const char = characters[step.char];

  const bubble=document.createElement("div");
  bubble.className="bubble "+char.side;

  const avatar=document.createElement("img");
  avatar.src=char.avatar;
  avatar.className="avatar";
  bubble.appendChild(avatar);

  /* ВИДЕО КАК СООБЩЕНИЕ */
  if(step.video){
    const v=document.createElement("video");
    v.src=step.video;
    v.controls=true;
    bubble.appendChild(v);
  }

  /* КАРТИНКА КАК СООБЩЕНИЕ */
  if(step.image){
    const img=document.createElement("img");
    img.src=step.image;
    img.className="media";
    bubble.appendChild(img);
  }

  /* ТЕКСТ */
  if(step.text){
    const msg=document.createElement("div");
    msg.className="msg";
    msg.textContent=char.name+": "+step.text;
    bubble.appendChild(msg);
  }

  chat.appendChild(bubble);
  index++;
  window.scrollTo(0,document.body.scrollHeight);
}
</script>

</body>
</html>
